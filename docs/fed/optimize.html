<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>优化相关 | note</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="a note space base on vue press">
    
    <link rel="preload" href="/note/assets/css/0.styles.19e75038.css" as="style"><link rel="preload" href="/note/assets/js/app.ce621578.js" as="script"><link rel="preload" href="/note/assets/js/2.062c8463.js" as="script"><link rel="preload" href="/note/assets/js/7.f346e578.js" as="script"><link rel="prefetch" href="/note/assets/js/10.67734478.js"><link rel="prefetch" href="/note/assets/js/11.fbe45be4.js"><link rel="prefetch" href="/note/assets/js/12.71ea4210.js"><link rel="prefetch" href="/note/assets/js/13.30347d30.js"><link rel="prefetch" href="/note/assets/js/14.9368e742.js"><link rel="prefetch" href="/note/assets/js/15.2cfc7e2a.js"><link rel="prefetch" href="/note/assets/js/16.4592177b.js"><link rel="prefetch" href="/note/assets/js/17.1d1a29fd.js"><link rel="prefetch" href="/note/assets/js/18.373695d1.js"><link rel="prefetch" href="/note/assets/js/19.d939c82a.js"><link rel="prefetch" href="/note/assets/js/20.d19f36d9.js"><link rel="prefetch" href="/note/assets/js/21.ebcfa334.js"><link rel="prefetch" href="/note/assets/js/22.f6803c03.js"><link rel="prefetch" href="/note/assets/js/23.5a815bfe.js"><link rel="prefetch" href="/note/assets/js/24.1c993a8a.js"><link rel="prefetch" href="/note/assets/js/25.02a9ac65.js"><link rel="prefetch" href="/note/assets/js/26.d265e6ac.js"><link rel="prefetch" href="/note/assets/js/27.70a44627.js"><link rel="prefetch" href="/note/assets/js/3.e7bd1fab.js"><link rel="prefetch" href="/note/assets/js/4.d0ef0939.js"><link rel="prefetch" href="/note/assets/js/5.e27c5686.js"><link rel="prefetch" href="/note/assets/js/6.029396af.js"><link rel="prefetch" href="/note/assets/js/8.ca3bcf38.js"><link rel="prefetch" href="/note/assets/js/9.5d420f35.js">
    <link rel="stylesheet" href="/note/assets/css/0.styles.19e75038.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/note/" class="home-link router-link-active"><!----> <span class="site-name">note</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/note/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/note/todo/" class="nav-link">
  todo
</a></div><div class="nav-item"><a href="/note/bed/" class="nav-link">
  bed
</a></div><div class="nav-item"><a href="/note/fed/" class="nav-link router-link-active">
  fed
</a></div><div class="nav-item"><a href="/note/deploy/" class="nav-link">
  deploy
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/note/" class="nav-link">
  home
</a></div><div class="nav-item"><a href="/note/todo/" class="nav-link">
  todo
</a></div><div class="nav-item"><a href="/note/bed/" class="nav-link">
  bed
</a></div><div class="nav-item"><a href="/note/fed/" class="nav-link router-link-active">
  fed
</a></div><div class="nav-item"><a href="/note/deploy/" class="nav-link">
  deploy
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/note/fed/vite.html" class="sidebar-link">vue2</a></li><li><a href="/note/fed/ts.html" class="sidebar-link">TypeScript</a></li><li><a href="/note/fed/nginx.html" class="sidebar-link">nginx</a></li><li><a href="/note/fed/optimize.html" aria-current="page" class="active sidebar-link">优化相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note/fed/optimize.html#浏览器工作原理" class="sidebar-link">浏览器工作原理</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="优化相关"><a href="#优化相关" class="header-anchor">#</a> 优化相关</h1> <h2 id="浏览器工作原理"><a href="#浏览器工作原理" class="header-anchor">#</a> 浏览器工作原理</h2> <p>参考资料：
<a href="https://developer.mozilla.org/zh-CN/docs/Web/Performance/How_browsers_work" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/zh-CN/docs/Web/Performance/How_browsers_work<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://developer.mozilla.org/en-US/docs/Web/Performance/Critical_rendering_path" target="_blank" rel="noopener noreferrer">https://developer.mozilla.org/en-US/docs/Web/Performance/Critical_rendering_path<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="解析"><a href="#解析" class="header-anchor">#</a> 解析</h3> <ol><li><p>构建DOM Tree
浏览器解析并构建dom tree 。</p> <blockquote><p>According to the Document Object Model (DOM), every HTML tag is an object. Nested tags are “children” of the enclosing one. The text inside a tag is an object as well.</p></blockquote> <p>DOM树描述了文档的内容。<code>html</code>元素是第一个标签也是文档树的根节点。树反映了不同标记之间的关系和层次结构。嵌套在其他标记中的标记是子节点。DOM节点的数量越多，构建DOM树所需的时间就越长。</p> <p><code>&lt;script&gt;</code>标签(不带有 async  defer属性) 会阻塞HTML的解析,占用线程 。
<strong>解析时等待获取css 图片 font 等不会阻塞HTML解析</strong></p></li> <li><p>构建CSSDOM Tree
DOM和CSSOM是两棵树. 它们是独立的数据结构。
浏览器将CSS规则转换为可以理解和使用的样式映射。浏览器遍历CSS中的每个规则集，根据CSS选择器创建具有父、子和兄弟关系的节点树。
浏览器从适用于节点的最通用规则开始，并通过应用更具体的规则递归地优化计算的样式。</p></li></ol> <h3 id="渲染"><a href="#渲染" class="header-anchor">#</a> 渲染</h3> <p><strong>步骤包括样式、布局、绘制，在某些情况下还包括合成</strong></p> <ol start="3"><li><p>Style
DOM tree 和 CSSDOM tree 进行结合 ==》 Render tree.
DOM树的根开始构建，遍历每个可见节点。 在 render tree 中，所有DOM都应用了对应的CSSDOM</p></li> <li><p>Layout</p> <p>第一次确定节点的大小和位置称为布局。随后对节点大小和位置的重新计算称为回流。
第四步是在渲染树上运行布局以计算每个节点的几何体。布局是确定呈现树中所有节点的宽度、高度和位置，以及确定页面上每个对象的大小和位置的过程。
回流是对页面的任何部分或整个文档的任何后续大小和位置的确定。
为了确定每个对象的确切大小和位置，浏览器从Render DOM的根开始遍历它。</p></li> <li><p>Paint
最后一步是将各个节点绘制到屏幕上，。在绘制或光栅化阶段，浏览器将在布局阶段计算的每个框转换为屏幕上的实际像素。
绘画包括将元素的每个可视部分绘制到屏幕上，包括文本、颜色、边框、阴影和替换的元素（如按钮和图像）.</p> <p>绘制可以将布局树中的元素分解为多个层。将内容提升到GPU上的层（而不是CPU上的主线程）可以提高绘制和重新绘制性能。
当文档的各个部分以不同的层绘制，相互重叠时，必须进行合成，以确保它们以正确的顺序绘制到屏幕上，并正确显示内容。</p> <p>为了确保重绘的速度比初始绘制的速度更快，屏幕上的绘图通常被分解成数层。如果发生这种情况，则需要进行合成。</p> <p><strong>为了减小布局事件的频率和时长，批量更新或者避免改动盒模型属性</strong> <img src="data:image/png;base64,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" alt="关键渲染路径">;</p></li></ol> <p>优化方向:</p> <ul><li><p>减少阻塞 :
js 会阻塞主线程解析HTML ，不重要的js放到后面加载或异步加载。
获取css不阻塞html 解析，但是会阻塞js ，因为js会查询css信息。</p></li> <li><p>减少重排
Layout阶段， 确定节点的大小和位置。 大小 ，位置，dom 元素变动 增加 删除 都会造成Layout变化，reLayout + rePaint。
缓存dom ，修改完成后 ，在进行替换</p></li> <li><p>减少重绘
Paint 阶段，绘制到屏幕上 ，bg ，text 等改变都引起，浏览器做过最小rePaint 优化。
可以合并DOM 操作 ，改style --&gt;改class</p></li> <li><p>节流： scroll 等事件</p></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/13/2021, 5:57:24 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note/fed/nginx.html" class="prev">
        nginx
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note/assets/js/app.ce621578.js" defer></script><script src="/note/assets/js/2.062c8463.js" defer></script><script src="/note/assets/js/7.f346e578.js" defer></script>
  </body>
</html>
